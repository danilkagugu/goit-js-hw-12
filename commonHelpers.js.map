{"version":3,"file":"commonHelpers.js","sources":["../src/main.js"],"sourcesContent":["import iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\n\nimport SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\n\nimport axios from 'axios';\n\nconst modalLightboxGallery = new SimpleLightbox('.gallery a', {\n  captionsData: 'alt',\n  captionDelay: 250,\n});\n\nconst searchForm = document.querySelector('.js-search-form');\nconst ulEl = document.querySelector('.list-photo');\nconst btnLoadMore = document.querySelector('[data-action=\"load-more\"]');\nconst loader = document.querySelector('.loader');\nconst loaderLoadMore = document.querySelector('.loader-load-more');\n\nconst hiddenClass = 'is-hidden';\n\nlet page = 1;\n\nlet maxPage = 0;\n\nlet query = '';\n\nconst BASE_URL = 'https://pixabay.com/api';\nconst API_KEY = '41849458-2d98265cf06659a45ba73a30c';\n\nsearchForm.addEventListener('submit', handleSearch);\n\nasync function handleSearch(event) {\n  event.preventDefault();\n\n  ulEl.innerHTML = '';\n\n  loader.classList.remove(hiddenClass);\n\n  page = 1;\n\n  const form = event.currentTarget;\n  query = form.elements.query.value.trim();\n\n  if (!query) {\n    loader.classList.add(hiddenClass);\n\n    iziToast.show({\n      title: 'Error',\n      color: 'yellow',\n      message: 'Please search for something',\n    });\n    return;\n  }\n\n  try {\n    const { hits, totalHits } = await getPhotos(query);\n\n    maxPage = Math.ceil(totalHits / 40);\n\n    markupPhoto(hits, ulEl);\n    if (hits.length > 0 && hits.length !== totalHits) {\n      btnLoadMore.classList.remove(hiddenClass);\n      btnLoadMore.addEventListener('click', handleLoadMore);\n    } else if (!hits.length) {\n      iziToast.error({\n        title: 'Error',\n        message:\n          'Sorry, there are no images matching your search query. Please try again!',\n      });\n    } else {\n      btnLoadMore.classList.add(hiddenClass);\n    }\n  } catch (error) {\n    console.log(error);\n  } finally {\n    loader.classList.add(hiddenClass);\n\n    form.reset();\n  }\n}\n\nfunction getPhotos(value, page = 1) {\n  return axios\n    .get(`${BASE_URL}/`, {\n      params: {\n        key: API_KEY,\n        q: value,\n        image_type: 'photo',\n        orientation: 'horizontal',\n        safesearch: 'true',\n        per_page: 40,\n        page,\n      },\n    })\n    .then(({ data }) => data);\n}\n\n// ------------------------------------------------------------КНОПКА LOAD MORE-------------------------------------------------------------\n\nasync function handleLoadMore() {\n  page += 1;\n  loaderLoadMore.classList.remove(hiddenClass);\n  btnLoadMore.classList.add(hiddenClass);\n\n  const getHeightImgCard = document\n    .querySelector('.gallery-item')\n    .getBoundingClientRect();\n\n  console.log(getHeightImgCard);\n  try {\n    const { hits } = await getPhotos(query, page);\n    markupPhoto(hits, ulEl);\n  } catch (error) {\n    console.log(error);\n  } finally {\n    window.scrollBy({\n      top: getHeightImgCard.height * 2,\n      left: 0,\n      behavior: 'smooth',\n    });\n    loaderLoadMore.classList.add(hiddenClass);\n    btnLoadMore.classList.remove(hiddenClass);\n    if (page === maxPage) {\n      btnLoadMore.classList.add(hiddenClass);\n      btnLoadMore.removeEventListener('click', handleLoadMore);\n    }\n  }\n}\n\n// ------------------------------------------------------------РОЗМІТКА--------------------------------------------------------------------\n\nfunction markupPhoto(hits) {\n  const markup = hits\n    .map(\n      ({\n        webformatURL,\n        largeImageURL,\n        tags,\n        likes,\n        views,\n        comments,\n        downloads,\n      }) =>\n        `<li class=\"gallery-item\">\n          <a class=\"gallery-link\" href=\"${largeImageURL}\">\n            <img\n              class=\"gallery-image\"\n              src=\"${webformatURL}\"\n              alt=\"${tags}\"\n              width=\"360\"\n            />\n          </a>\n          <ul class=\"img-list\">\n  <li class=\"img-info\">\n   <p class=\"img-text\">Likes: <br><span>${likes}</span></p>\n   <p class=\"img-text\">Views: <br><span>${views}</span></p>\n   <p class=\"img-text\">Comment: <br><span>${comments}</span></p>\n   <p class=\"img-text\">Downloads: <br><span>${downloads}</span></p>\n   </li>\n   </ul>\n        </li>`\n    )\n    .join('');\n  ulEl.insertAdjacentHTML('beforeend', markup);\n  modalLightboxGallery.refresh();\n}\n"],"names":["modalLightboxGallery","SimpleLightbox","searchForm","ulEl","btnLoadMore","loader","loaderLoadMore","hiddenClass","page","maxPage","query","BASE_URL","API_KEY","handleSearch","event","form","iziToast","hits","totalHits","getPhotos","markupPhoto","handleLoadMore","error","value","axios","data","getHeightImgCard","markup","webformatURL","largeImageURL","tags","likes","views","comments","downloads"],"mappings":"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"}